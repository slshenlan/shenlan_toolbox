"use strict";(self["webpackChunkshenlan_tool"]=self["webpackChunkshenlan_tool"]||[]).push([[861],{26231:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page"},[t("Card",{staticClass:"sl-pub-card"},[t("div",{attrs:{slot:"title"},slot:"title"},[t("Select",{staticClass:"sl-width-150",attrs:{clearable:"",placeholder:"请选择图片类型"},model:{value:e.table.type.value,callback:function(t){e.$set(e.table.type,"value",t)},expression:"table.type.value"}},e._l(e.table.type.data,(function(a){return t("Option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1),t("div",{staticClass:"extra-bar",attrs:{slot:"extra"},slot:"extra"},[t("sl-upload",{on:{onToImage:e.uploadHandleBeforeUpload}},[t("Button",{attrs:{type:"success"}},[e._v("上传图片")])],1),t("Button",{staticClass:"sl-margin-left-10",attrs:{type:"primary"},on:{click:e.changeHandleExportImage}},[e._v("导出图片")]),t("Button",{staticClass:"sl-margin-left-10",attrs:{type:"error"},on:{click:e.tableClear}},[e._v("清空")])],1),t("div",[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.table.data.length,expression:"!table.data.length"}]},[t("sl-upload",{attrs:{"has-border":""},on:{onToImage:e.uploadHandleBeforeUpload}},[t("div",{staticStyle:{padding:"80px 0"}},[t("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),t("p",[e._v("点击或者拖拽图片到这里")]),t("p",{staticClass:"sub-title"},[e._v("最多上传15张图片")])],1)])],1),t("Table",{directives:[{name:"show",rawName:"v-show",value:e.table.data.length,expression:"table.data.length"}],attrs:{columns:e.table.columns,data:e.table.data,"max-height":e.table.maxHeight}})],1)])],1)},s=[],i=a(44512),n=(a(57658),{data(){return{table:{data:[],columns:[{type:"index",width:60,align:"center"},{title:"预览",render:(e,t)=>e("img",{attrs:{src:t.row.img.src},style:{width:"100px",marginTop:"4px"}})},{title:"名称",key:"fileName"},{title:"质量",render:(e,t)=>{let a=(t.row.size/1024).toFixed(2);return e("span",`${a}kb`)}},{title:"类型",key:"type"},{title:"操作",render:(e,t)=>e("span",{style:{color:"red",cursor:"pointer"},on:{click:()=>{this.table.data=this.table.data.reduce(((e,a,l)=>(l!==t.index&&e.push(a),e)),[])}}},"删除")}],type:{value:"",data:[{value:"jpeg",label:".jpeg"},{value:"png",label:".png"},{value:"webp",label:".webp"},{value:"ico",label:".ico"}]},maxHeight:480}}},mounted(){this.$nextTick((()=>{this.table.maxHeight=this.$pub.slGetCardBodyHeight()-30}))},methods:{tableClear(){this.table.data=[]}}}),o=a(27954),r=a.n(o),d=a(93640),p=a.n(d),c={data(){return{}},computed:{},beforeDestroy(){},mounted(){this.$nextTick((()=>{}))},methods:{changeHandleExportImage(){try{let e=this.table;if(!e.type.value)throw"请选择需要转换的图片类型";if(!e.data.length)throw"请先上传图片";this.$Spin.show({render:e=>e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","Loading")])}),this.renderExportImage()}catch(e){this.$Message.warning(e)}},renderExportImage(){let e=this.table,t=e.type.value,a=new(r()),l=a.folder("images");e.data.forEach(((s,i)=>{let n=s.img,o=document.createElement("canvas");o.width=n.width,o.height=n.height;let r=o.getContext("2d");r.drawImage(n,0,0,n.width,n.height),l.file(`${s.fileName.split(".")[0]}.${t}`,o.toDataURL(`image/${".ico"===t?"x-icon":t}`,1).substring(22),{base64:!0}),i===e.data.length-1&&(this.$Spin.hide(),a.generateAsync({type:"blob"}).then((function(e){p()(e,"images.zip")})))}))}}},h={methods:{uploadHandleBeforeUpload(e){this.table.data.push(e)}}},u={components:{SlUpload:i.Z},mixins:[n,c,h],data(){return{}},computed:{},watch:{},mounted(){},methods:{}},g=u,m=a(43736),b=(0,m.Z)(g,l,s,!1,null,null,null),v=b.exports}}]);